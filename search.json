[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "London SDE/AIC Docs",
    "section": "",
    "text": "Technical documentation for work in London SDE/AIC Programme\n[Placeholder]",
    "crumbs": [
      "MAIN",
      "Home"
    ]
  },
  {
    "objectID": "pages/data_model/cdm_person.html",
    "href": "pages/data_model/cdm_person.html",
    "title": "London SDE/AIC Technical Documentation",
    "section": "",
    "text": "Structured data sources for person and core demographic information will generally always include:\n\n\n\nTable\nType\n\n\n\n\nCommissioning Datasets\nLegacy\n\n\nPatient Information Management Systems\nLegacy\n\n\nElectronic Health Record patient index\nLive / ADT feed\n\n\nIndividual Observations / Facts\nLegacy + Live\n\n\n\nTables are loaded to the database in batches, or through incremental ingestion via connection to a source database.\n\n\n\nData sources are staged as stg_{source}__{entity} (if necessary, with an initial step of base_{source}__{entity} prior to unioning). This may include column renaming and edge case handling.\n\n\n\nDue to the large number of patient identification systems found in any hospital, and the possibility of patient ID duplication (and subsequent deduplication), we normalise all identifiers (including hospital IDs, NHS numbers, specific system IDs) under a person_uuid that we generate. Note that while NHS numbers are often seen as a canonical identifier, these exhibit significant missingness either due to failure to retrieve from NHS Spine, or because a patient is not registered in the NHS.\n\n\n\n\n\n---\ntitle: Person Identifier Lookup Table\n---\nerDiagram\n    int_person_identifier_lookup {\n        person_uuid uuid \"generated for each unique person\"\n        patient_id varchar \"patient identifier from source systems\"\n        patient_id_type varchar \"type of patient identifier\"\n        valid_from date \"date of record creation\"\n        valid_to date \"date of record deprecation (e.g. if lookup no longer valid)\"\n    }\n\n\n\n\n\n\n\n\n\nThe source tables which contain patient demographics are a combination of normalised tables, and flat / wide tables, and may be maintained as type 1 or 2 SCD. We normalise patient characteristics found in these tables to enable visibility over changing and/or conflicting information (data handling decisions are pushed to a later stage).\nNormalised tables handle core characteristics, that we treat as patient dimensions.\n\n\n\n\n\n---\ntitle: Person Intermediate Tables\n---\nerDiagram\n    int_person_birth {\n        person_uuid uuid \"[PK] generated for each unique person\"\n        year_of_birth integer \"[not null]\"\n        month_of_birth integer\n        day_of_birth integer\n        birth_datetime timestamp\n        source_table_provenance varchar50 \"source table name\"\n        source_row_id uuid \"unique row id for the single concept that is generated at ingestion\"\n    }\n    int_person_birth ||--|{ int_person_gender : \"has gender\"\n    int_person_gender {\n        person_uuid uuid \"[FK] int_person_birth\"\n        gender_source_value varchar \"gender code from source system\"\n        gender_source_value_name varchar \"gender descriptive name from source system\"        \n        gender_type varchar \"type of gender (e.g. Epic - phenotypic)\"\n        domain_id varchar \"most relevant omop domain\"\n        source_vocabulary_id varchar \"id of source vocab\"        \n        source_table_provenance varchar \"source table name\"\n        source_row_id uuid \"unique row id for the single concept that is generated at ingestion\"\n        date_valid date \"date of record creation\"\n        date_invalid date \"date of record deprecation (e.g. if data item no longer valid)\"\n    }\n    int_person_birth ||--|{ int_person_ethnicity : \"has ethnicity\"\n    int_person_ethnicity {\n        person_uuid uuid \"[FK] int_person_birth\"\n        ethnicity_source_value varchar20 \"ethnicity code from source system\"\n        ethnicity_source_value_name varchar20 \"ethnicity descriptive name from source system\"\n        domain_id varchar \"most relevant omop domain\"\n        source_vocabulary_id varchar \"id of source vocab\"                 \n        source_table_provenance varchar50 \"source table name\"\n        source_row_id uuid \"unique row id for the single concept that is generated at ingestion\"\n        date_valid date \"date of record creation\"\n        date_invalid date \"date of record deprecation (e.g. if data item no longer valid)\"\n    }\n\n\n\n\n\n\n\n\n\nDeprivation is derived from patient postcode. The remaining parts of address are discarded.\n\n\n\n\n\n---\ntitle: Person Intermediate Table (Deprivation)\n---\nerDiagram\n    int_person_birth {\n        person_uuid uuid \"[PK] generated for each unique person\"\n        year_of_birth integer\n        month_of_birth integer\n        day_of_birth integer\n        birth_datetime timestamp\n        source_table_provenance varchar \"source table name\"\n        source_row_id uuid \"unique row id for the single concept that is generated at ingestion\"\n    }\n    int_person_birth ||--|{ int_person_deprivation : \"has deprivation\"\n        int_person_deprivation {\n        person_uuid uuid \"[FK] int_person_birth\"\n        postcode varchar \"postcode with space\"\n        deprivation_decile_as_number integer \"NHS IMD decile\"       \n        deprivation_index_as_number integer \"NHS IMD ranking\"\n        source_table_provenance varchar \"source table name\"\n        source_row_id uuid \"unique row id for the single concept that is generated at ingestion\"\n        valid_from date \"date of record creation\"\n        valid_to date \"date of record deprecation (e.g. if data item no longer valid)\"\n    }\n\n\n\n\n\n\n\n\n\nThis is the transformed version of ingested person and demographic tables. Concepts in this table are mapped to OMOP standards, and column naming is compatible, but it contains the following differences:\n\nStandardised concept codes/names are surfaced, and indexed, to enable user-friendly exploration and visualisation without the need for large joins;\nAdditional demographic fields for UK specific deprivation are included;\nOMOP CDM 5.4 columns that are not relevant to the NHS, or to intended purposes, are excluded. When converting to vanilla OMOP, these columns remain empty.\nTo populate this, logic is applied to surface the most recent and reliable dimensions based on intermediate tables.\n\n\n\n\n\n\n---\ntitle: OMOP-EXT Person\n---\nerDiagram\n    ext_person {\n        person_uuid uuid \"[PK] generated for each unique person\"\n        gender_concept_id integer \"OMOP standard concept id\"\n        gender_concept_code varchar \"OMOP standard concept code\"\n        gender_concept_name varchar \"OMOP standard concept name\"\n        year_of_birth integer\n        month_of_birth integer\n        day_of_birth integer\n        birth_datetime timestamp\n        race_concept_id integer \"OMOP standard concept id, race = ethnicity in NHS\"\n        race_concept_code varchar \"OMOP standard concept code\"\n        race_concept_name varchar \"OMOP standard concept name\"      \n        deprivation_decile_as_number integer \"NHS IMD decile\"       \n        deprivation_index_as_number integer \"NHS IMD ranking\"\n        person_source_value varchar \"populate with nhs number where available\"\n        gender_source_value varchar\n        race_source_value varchar\n    }\n\n\n\n\n\n\n\n\n\nCentral identity management for all persons in the OMOP data model. It contains records that uniquely identify each person or patient, and some demographic information. The canonical OMOP table is shown below.\n\n\n\n\n\n---\ntitle: OMOP Person Table\n---\nerDiagram\n    person {\n        person_id integer \"[PK not null]\"\n        gender_concept_id integer \"[not null]\"\n        year_of_birth integer \"[not null]\"\n        month_of_birth integer\n        day_of_birth integer\n        birth_datetime timestamp\n        race_concept_id integer \"[not null] race or ethnicity\"\n        ethnicity_concept_id integer \"[not null] US-specific hispanic vs non-hispanic\"\n        location_id integer \"patient physical address\"\n        provider_id integer \"GP who is primary care provider\"\n        care_site_id integer \"GP surgery for primary care\"\n        person_source_value varchar50 \"nhs number where available\"\n        gender_source_value varchar50 \"biological sex as represented in source\"\n        gender_source_concept_id integer \"mapping to omop, but often empty\"\n        race_source_value varchar50 \"race or ethnicity as represented in source\"\n        race_source_concept_id integer \"mapping to omop, but often empty\"\n        ethnicity_source_value varchar50 \"US-specific as represented in source\"\n        ethnicity_source_concept_id integer \"mapping to omop, but often empty\"\n    }\n\n\n\n\n\n\n\n\n\nNone for now!\n\n\n\nNone for now!",
    "crumbs": [
      "COMMON DATA MODEL",
      "Table/PERSON"
    ]
  },
  {
    "objectID": "pages/data_model/cdm_person.html#person",
    "href": "pages/data_model/cdm_person.html#person",
    "title": "London SDE/AIC Technical Documentation",
    "section": "",
    "text": "Structured data sources for person and core demographic information will generally always include:\n\n\n\nTable\nType\n\n\n\n\nCommissioning Datasets\nLegacy\n\n\nPatient Information Management Systems\nLegacy\n\n\nElectronic Health Record patient index\nLive / ADT feed\n\n\nIndividual Observations / Facts\nLegacy + Live\n\n\n\nTables are loaded to the database in batches, or through incremental ingestion via connection to a source database.\n\n\n\nData sources are staged as stg_{source}__{entity} (if necessary, with an initial step of base_{source}__{entity} prior to unioning). This may include column renaming and edge case handling.\n\n\n\nDue to the large number of patient identification systems found in any hospital, and the possibility of patient ID duplication (and subsequent deduplication), we normalise all identifiers (including hospital IDs, NHS numbers, specific system IDs) under a person_uuid that we generate. Note that while NHS numbers are often seen as a canonical identifier, these exhibit significant missingness either due to failure to retrieve from NHS Spine, or because a patient is not registered in the NHS.\n\n\n\n\n\n---\ntitle: Person Identifier Lookup Table\n---\nerDiagram\n    int_person_identifier_lookup {\n        person_uuid uuid \"generated for each unique person\"\n        patient_id varchar \"patient identifier from source systems\"\n        patient_id_type varchar \"type of patient identifier\"\n        valid_from date \"date of record creation\"\n        valid_to date \"date of record deprecation (e.g. if lookup no longer valid)\"\n    }\n\n\n\n\n\n\n\n\n\nThe source tables which contain patient demographics are a combination of normalised tables, and flat / wide tables, and may be maintained as type 1 or 2 SCD. We normalise patient characteristics found in these tables to enable visibility over changing and/or conflicting information (data handling decisions are pushed to a later stage).\nNormalised tables handle core characteristics, that we treat as patient dimensions.\n\n\n\n\n\n---\ntitle: Person Intermediate Tables\n---\nerDiagram\n    int_person_birth {\n        person_uuid uuid \"[PK] generated for each unique person\"\n        year_of_birth integer \"[not null]\"\n        month_of_birth integer\n        day_of_birth integer\n        birth_datetime timestamp\n        source_table_provenance varchar50 \"source table name\"\n        source_row_id uuid \"unique row id for the single concept that is generated at ingestion\"\n    }\n    int_person_birth ||--|{ int_person_gender : \"has gender\"\n    int_person_gender {\n        person_uuid uuid \"[FK] int_person_birth\"\n        gender_source_value varchar \"gender code from source system\"\n        gender_source_value_name varchar \"gender descriptive name from source system\"        \n        gender_type varchar \"type of gender (e.g. Epic - phenotypic)\"\n        domain_id varchar \"most relevant omop domain\"\n        source_vocabulary_id varchar \"id of source vocab\"        \n        source_table_provenance varchar \"source table name\"\n        source_row_id uuid \"unique row id for the single concept that is generated at ingestion\"\n        date_valid date \"date of record creation\"\n        date_invalid date \"date of record deprecation (e.g. if data item no longer valid)\"\n    }\n    int_person_birth ||--|{ int_person_ethnicity : \"has ethnicity\"\n    int_person_ethnicity {\n        person_uuid uuid \"[FK] int_person_birth\"\n        ethnicity_source_value varchar20 \"ethnicity code from source system\"\n        ethnicity_source_value_name varchar20 \"ethnicity descriptive name from source system\"\n        domain_id varchar \"most relevant omop domain\"\n        source_vocabulary_id varchar \"id of source vocab\"                 \n        source_table_provenance varchar50 \"source table name\"\n        source_row_id uuid \"unique row id for the single concept that is generated at ingestion\"\n        date_valid date \"date of record creation\"\n        date_invalid date \"date of record deprecation (e.g. if data item no longer valid)\"\n    }\n\n\n\n\n\n\n\n\n\nDeprivation is derived from patient postcode. The remaining parts of address are discarded.\n\n\n\n\n\n---\ntitle: Person Intermediate Table (Deprivation)\n---\nerDiagram\n    int_person_birth {\n        person_uuid uuid \"[PK] generated for each unique person\"\n        year_of_birth integer\n        month_of_birth integer\n        day_of_birth integer\n        birth_datetime timestamp\n        source_table_provenance varchar \"source table name\"\n        source_row_id uuid \"unique row id for the single concept that is generated at ingestion\"\n    }\n    int_person_birth ||--|{ int_person_deprivation : \"has deprivation\"\n        int_person_deprivation {\n        person_uuid uuid \"[FK] int_person_birth\"\n        postcode varchar \"postcode with space\"\n        deprivation_decile_as_number integer \"NHS IMD decile\"       \n        deprivation_index_as_number integer \"NHS IMD ranking\"\n        source_table_provenance varchar \"source table name\"\n        source_row_id uuid \"unique row id for the single concept that is generated at ingestion\"\n        valid_from date \"date of record creation\"\n        valid_to date \"date of record deprecation (e.g. if data item no longer valid)\"\n    }\n\n\n\n\n\n\n\n\n\nThis is the transformed version of ingested person and demographic tables. Concepts in this table are mapped to OMOP standards, and column naming is compatible, but it contains the following differences:\n\nStandardised concept codes/names are surfaced, and indexed, to enable user-friendly exploration and visualisation without the need for large joins;\nAdditional demographic fields for UK specific deprivation are included;\nOMOP CDM 5.4 columns that are not relevant to the NHS, or to intended purposes, are excluded. When converting to vanilla OMOP, these columns remain empty.\nTo populate this, logic is applied to surface the most recent and reliable dimensions based on intermediate tables.\n\n\n\n\n\n\n---\ntitle: OMOP-EXT Person\n---\nerDiagram\n    ext_person {\n        person_uuid uuid \"[PK] generated for each unique person\"\n        gender_concept_id integer \"OMOP standard concept id\"\n        gender_concept_code varchar \"OMOP standard concept code\"\n        gender_concept_name varchar \"OMOP standard concept name\"\n        year_of_birth integer\n        month_of_birth integer\n        day_of_birth integer\n        birth_datetime timestamp\n        race_concept_id integer \"OMOP standard concept id, race = ethnicity in NHS\"\n        race_concept_code varchar \"OMOP standard concept code\"\n        race_concept_name varchar \"OMOP standard concept name\"      \n        deprivation_decile_as_number integer \"NHS IMD decile\"       \n        deprivation_index_as_number integer \"NHS IMD ranking\"\n        person_source_value varchar \"populate with nhs number where available\"\n        gender_source_value varchar\n        race_source_value varchar\n    }\n\n\n\n\n\n\n\n\n\nCentral identity management for all persons in the OMOP data model. It contains records that uniquely identify each person or patient, and some demographic information. The canonical OMOP table is shown below.\n\n\n\n\n\n---\ntitle: OMOP Person Table\n---\nerDiagram\n    person {\n        person_id integer \"[PK not null]\"\n        gender_concept_id integer \"[not null]\"\n        year_of_birth integer \"[not null]\"\n        month_of_birth integer\n        day_of_birth integer\n        birth_datetime timestamp\n        race_concept_id integer \"[not null] race or ethnicity\"\n        ethnicity_concept_id integer \"[not null] US-specific hispanic vs non-hispanic\"\n        location_id integer \"patient physical address\"\n        provider_id integer \"GP who is primary care provider\"\n        care_site_id integer \"GP surgery for primary care\"\n        person_source_value varchar50 \"nhs number where available\"\n        gender_source_value varchar50 \"biological sex as represented in source\"\n        gender_source_concept_id integer \"mapping to omop, but often empty\"\n        race_source_value varchar50 \"race or ethnicity as represented in source\"\n        race_source_concept_id integer \"mapping to omop, but often empty\"\n        ethnicity_source_value varchar50 \"US-specific as represented in source\"\n        ethnicity_source_concept_id integer \"mapping to omop, but often empty\"\n    }\n\n\n\n\n\n\n\n\n\nNone for now!\n\n\n\nNone for now!",
    "crumbs": [
      "COMMON DATA MODEL",
      "Table/PERSON"
    ]
  },
  {
    "objectID": "pages/data_model/cdm_measurement.html",
    "href": "pages/data_model/cdm_measurement.html",
    "title": "London SDE/AIC Technical Documentation",
    "section": "",
    "text": "Structured data sources for standardised clinical tests and measurements will generally always include:\n\n\n\nTable\nType\n\n\n\n\nLaboratory information systems\nLegacy + Live\n\n\nVital signs recording systems\nLegacy + Live\n\n\nObservation recording flowsheets\nLegacy + Live\n\n\n\nTables are loaded to the database in batches, or through incremental ingestion via connection to a source database.\n\n\n\nData sources are staged as stg_{source}__{entity} (if necessary, with an initial step of base_{source}__{entity} prior to unioning). This may include column renaming and edge case handling.\n\n\n\nDifferent data sources are UNIONED into a common dataset for representing categorical or numerical results of laboratory tests or other tests on a patient sample.\nPatients must first be assigned a person_uuid. Where dispensing is attached to a particular hospital admission or attendance, these spells or attendances must first be assigned a visit_occurrence_id.\n\n\n\n\n\n---\ntitle: Measurement (Laboratory) Intermediate Table\n---\nerDiagram\n    int_measurement_laboratorytest {\n        measurement_id integer \"[PK] autogenerated identifier\"\n        person_uuid uuid \"[FK ext_person] standardised unique person id\"\n        measurement_date date\n        measurement_datetime datetime    \n        measurement_source_value varchar \"measurement code as represented in source\"\n        measurement_source_value_name varchar \"measurement name as represented in source\"\n        domain_id varchar \"most relevant omop domain\"\n        source_vocabulary_id varchar \"id of source vocab\"\n        measurement_location varchar \"free text for location context - e.g. ward name, or inpatient, outpatient\"\n        measurement_desc varchar \"additional free text for any further qualification\"\n        operator_source_value varchar \"verbatim operator as in source\"\n        value_source_value varchar \"verbatim value described in source\"\n        unit_source_value varchar \"verbatim unit as in source\"               \n        value_as_number float \"numerical value of the result of the measurement\"\n        value_as_categorical varchar \"categorical results\"        \n        range_low float \"normal range low\"\n        range_high float  \"normal range high\"\n        range_unit varchar \"range units\"\n        measurement_event_id integer \"link to PK of related record (assume in same table)\"\n        visit_occurrence_id integer \"[FK ext_visit_occurrence] standardised unique visit id\"\n        source_table_provenance varchar \"source table name\"\n        source_row_id uuid \"unique row id for the single concept that is generated at ingestion\"\n    }\n\n\n\n\n\n\n\n\n\nDifferent data sources are UNIONED into a common dataset for representing categorical or numerical clinical observations such as vital signs or other quantitative findings based on a patient.\nPatients must first be assigned a person_uuid. Where dispensing is attached to a particular hospital admission or attendance, these spells or attendances must first be assigned a visit_occurrence_id.\n\n\n\n\n\n---\ntitle: Measurement (ClinicalObs) Intermediate Table\n---\nerDiagram\n    int_measurement_clinicalobs {\n        measurement_id integer \"[PK] autogenerated identifier\"\n        person_uuid uuid \"[FK ext_person] standardised unique person id\"\n        measurement_date date\n        measurement_datetime datetime    \n        measurement_source_value varchar \"measurement code as represented in source\"\n        measurement_source_value_name varchar \"measurement name as represented in source\"\n        domain_id varchar \"most relevant omop domain\"\n        source_vocabulary_id varchar \"id of source vocab\"\n        measurement_location varchar \"free text for location context - e.g. ward name, or inpatient, outpatient\"\n        measurement_desc varchar \"additional free text for any further qualification\"        \n        operator_source_value varchar \"verbatim operator as in source\"\n        value_source_value varchar \"verbatim value described in source\"\n        unit_source_value varchar \"verbatim unit as in source\"               \n        value_as_number float \"numerical value of the result of the measurement\"\n        value_as_categorical varchar \"categorical results\"        \n        range_low float \"normal range low\"\n        range_high float  \"normal range high\"\n        range_unit varchar \"range units\"\n        measurement_event_id integer \"link to PK of related record (assume in same table)\"\n        visit_occurrence_id integer \"[FK ext_visit_occurrence] standardised unique visit id\"\n        source_table_provenance varchar \"source table name\"\n        source_row_id uuid \"unique row id for the single concept that is generated at ingestion\"\n    }\n\n\n\n\n\n\n\n\n\nThis is the transformed version of ingested measurement tables. It includes results of tests on samples and measurements recorded directly for patients. Concepts in this table are mapped to OMOP standards, and column naming is compatible, but it contains the following differences:\n\nStandardised concept codes/names are surfaced, and indexed, to enable user-friendly exploration and visualisation without the need for large joins;\nOMOP CDM 5.4 columns that are not relevant to the NHS, or to intended purposes, are excluded. When converting to vanilla OMOP, these columns remain empty;\nSource, table, and systems provenance are maintained.\nSystems source is used to map to measurement_type_concept_id per OMOP.\n\n\n\n\n\n\n---\ntitle: OMOP-EXT Measurement\n---\nerDiagram\n    ext_measurement {\n        measurement_id integer \"[PK] autogenerated identifier\"\n        person_uuid uuid \"[FK ext_person] standardised unique person id\"\n        measurement_date date\n        measurement_datetime datetime\n        measurement_concept_id integer \"OMOP standard concept id\"\n        measurement_concept_code varchar \"OMOP standard concept code\"\n        measurement_concept_name varchar \"OMOP standard concept name\"\n        vocabulary_id varchar \"OMOP standard vocabulary\" \n        measurement_type_concept_id integer \"OMOP provenance/type of measurement\" \n        measurement_type_concept_name integer \"OMOP provenance/type of measurement as text\"   \n        measurement_location varchar \"free text for location context - e.g. ward name, or inpatient, outpatient, TTA\"\n        operator_concept_id integer \"OMOP standard concept id, omission here is equivalent to '='\"\n        operator_concept_name varchar \"OMOP operator name for visibility\"         \n        value_as_number float \"numerical value of the result of the measurement\"\n        value_as_concept_id integer \"OMOP concept id to represent specific categorical values in Meas Value domain\"\n        value_as_categorical varchar \"categorical results\"\n        unit_concept_id integer \"OMOP concept id to represent unit of measurement\"\n        unit_concept_name varchar \"OMOP unit name for visibility\"\n        range_low float \"normal range low\"\n        range_high float  \"normal range high\"\n        range_unit varchar \"range units\"           \n        measurement_source_value varchar \"measurement code as represented in source\"\n        measurement_source_value_name varchar \"measurement name as represented in source\"\n        value_source_value varchar \"verbatim value as described in source\"\n        visit_occurrence_id integer \"[FK ext_visit_occurrence] standardised unique visit id\"\n        source_table_provenance varchar \"source table name\"\n        source_row_id uuid \"unique row id for the single concept that is generated at ingestion\"\n    }\n\n\n\n\n\n\n\n\n\nThe MEASUREMENT table contains records of Measurements, i.e. structured values (numerical or categorical) obtained through systematic and standardized examination or testing of a Person or Person’s sample. The MEASUREMENT table contains both orders and results of such Measurements as laboratory tests, vital signs, quantitative findings from pathology reports, etc. Measurements are stored as attribute value pairs, with the attribute as the Measurement Concept and the value representing the result. The value can be a Concept (stored in VALUE_AS_CONCEPT), or a numerical value (VALUE_AS_NUMBER) with a Unit (UNIT_CONCEPT_ID). Measurements differ from Observations in that they require a standardized test or some other activity to generate a quantitative or qualitative result. If there is no result, it is assumed that the lab test was conducted but the result was not captured.\n\n\n\n\n\n---\ntitle: OMOP.MEASUREMENT\n---\nerDiagram\n    MEASUREMENT {\n        measurement_id integer \"[PK not null] autogenerated identifier\"\n        person_id integer \"[FK not null]\"\n        measurement_concept_id integer \"[not null] standard OMOP concept id used for analyses\"\n        measurement_date date \"[not null]\"\n        measurement_datetime datetime\n        measurement_time timestamp\n        measurement_type_concept_id integer \"[not null] provenance of measurement value per OMOP\"\n        operator_concept_id integer \"omission here is equivalent to '='\"         \n        value_as_number float \"numerical value of the result of the measurement\"\n        value_as_concept_id integer \"standard concept result for categorical values in Meas Value domain\"\n        unit_concept_id integer\n        range_low float\n        range_high float\n        provider_id integer \"[FK] clinician provider who recorded condition\"\n        visit_occurrence_id integer \"[FK]\"\n        visit_detail_id integer \"[FK]\"\n        measurement_source_value varchar50 \"concept code as represented in source\"\n        measurement_source_concept_id integer \"source mapped to omop but often left empty\"\n        unit_source_value varchar50 \"verbatim unit given in source\"\n        unit_source_concept_id integer \"source unit mapped to omop\"\n        value_source_value varchar50 \"verbatim result value of the measurement in source\"\n        measurement_event_id integer \"link to a related record in the db\"\n        meas_event_field_concept_id integer \"concept id identifying the TABLE that is linked\"\n    }\n\n\n\n\n\n\n\n\n\nNone for now!\n\n\n\nNone for now!",
    "crumbs": [
      "COMMON DATA MODEL",
      "Table/MEASUREMENT"
    ]
  },
  {
    "objectID": "pages/data_model/cdm_measurement.html#measurement",
    "href": "pages/data_model/cdm_measurement.html#measurement",
    "title": "London SDE/AIC Technical Documentation",
    "section": "",
    "text": "Structured data sources for standardised clinical tests and measurements will generally always include:\n\n\n\nTable\nType\n\n\n\n\nLaboratory information systems\nLegacy + Live\n\n\nVital signs recording systems\nLegacy + Live\n\n\nObservation recording flowsheets\nLegacy + Live\n\n\n\nTables are loaded to the database in batches, or through incremental ingestion via connection to a source database.\n\n\n\nData sources are staged as stg_{source}__{entity} (if necessary, with an initial step of base_{source}__{entity} prior to unioning). This may include column renaming and edge case handling.\n\n\n\nDifferent data sources are UNIONED into a common dataset for representing categorical or numerical results of laboratory tests or other tests on a patient sample.\nPatients must first be assigned a person_uuid. Where dispensing is attached to a particular hospital admission or attendance, these spells or attendances must first be assigned a visit_occurrence_id.\n\n\n\n\n\n---\ntitle: Measurement (Laboratory) Intermediate Table\n---\nerDiagram\n    int_measurement_laboratorytest {\n        measurement_id integer \"[PK] autogenerated identifier\"\n        person_uuid uuid \"[FK ext_person] standardised unique person id\"\n        measurement_date date\n        measurement_datetime datetime    \n        measurement_source_value varchar \"measurement code as represented in source\"\n        measurement_source_value_name varchar \"measurement name as represented in source\"\n        domain_id varchar \"most relevant omop domain\"\n        source_vocabulary_id varchar \"id of source vocab\"\n        measurement_location varchar \"free text for location context - e.g. ward name, or inpatient, outpatient\"\n        measurement_desc varchar \"additional free text for any further qualification\"\n        operator_source_value varchar \"verbatim operator as in source\"\n        value_source_value varchar \"verbatim value described in source\"\n        unit_source_value varchar \"verbatim unit as in source\"               \n        value_as_number float \"numerical value of the result of the measurement\"\n        value_as_categorical varchar \"categorical results\"        \n        range_low float \"normal range low\"\n        range_high float  \"normal range high\"\n        range_unit varchar \"range units\"\n        measurement_event_id integer \"link to PK of related record (assume in same table)\"\n        visit_occurrence_id integer \"[FK ext_visit_occurrence] standardised unique visit id\"\n        source_table_provenance varchar \"source table name\"\n        source_row_id uuid \"unique row id for the single concept that is generated at ingestion\"\n    }\n\n\n\n\n\n\n\n\n\nDifferent data sources are UNIONED into a common dataset for representing categorical or numerical clinical observations such as vital signs or other quantitative findings based on a patient.\nPatients must first be assigned a person_uuid. Where dispensing is attached to a particular hospital admission or attendance, these spells or attendances must first be assigned a visit_occurrence_id.\n\n\n\n\n\n---\ntitle: Measurement (ClinicalObs) Intermediate Table\n---\nerDiagram\n    int_measurement_clinicalobs {\n        measurement_id integer \"[PK] autogenerated identifier\"\n        person_uuid uuid \"[FK ext_person] standardised unique person id\"\n        measurement_date date\n        measurement_datetime datetime    \n        measurement_source_value varchar \"measurement code as represented in source\"\n        measurement_source_value_name varchar \"measurement name as represented in source\"\n        domain_id varchar \"most relevant omop domain\"\n        source_vocabulary_id varchar \"id of source vocab\"\n        measurement_location varchar \"free text for location context - e.g. ward name, or inpatient, outpatient\"\n        measurement_desc varchar \"additional free text for any further qualification\"        \n        operator_source_value varchar \"verbatim operator as in source\"\n        value_source_value varchar \"verbatim value described in source\"\n        unit_source_value varchar \"verbatim unit as in source\"               \n        value_as_number float \"numerical value of the result of the measurement\"\n        value_as_categorical varchar \"categorical results\"        \n        range_low float \"normal range low\"\n        range_high float  \"normal range high\"\n        range_unit varchar \"range units\"\n        measurement_event_id integer \"link to PK of related record (assume in same table)\"\n        visit_occurrence_id integer \"[FK ext_visit_occurrence] standardised unique visit id\"\n        source_table_provenance varchar \"source table name\"\n        source_row_id uuid \"unique row id for the single concept that is generated at ingestion\"\n    }\n\n\n\n\n\n\n\n\n\nThis is the transformed version of ingested measurement tables. It includes results of tests on samples and measurements recorded directly for patients. Concepts in this table are mapped to OMOP standards, and column naming is compatible, but it contains the following differences:\n\nStandardised concept codes/names are surfaced, and indexed, to enable user-friendly exploration and visualisation without the need for large joins;\nOMOP CDM 5.4 columns that are not relevant to the NHS, or to intended purposes, are excluded. When converting to vanilla OMOP, these columns remain empty;\nSource, table, and systems provenance are maintained.\nSystems source is used to map to measurement_type_concept_id per OMOP.\n\n\n\n\n\n\n---\ntitle: OMOP-EXT Measurement\n---\nerDiagram\n    ext_measurement {\n        measurement_id integer \"[PK] autogenerated identifier\"\n        person_uuid uuid \"[FK ext_person] standardised unique person id\"\n        measurement_date date\n        measurement_datetime datetime\n        measurement_concept_id integer \"OMOP standard concept id\"\n        measurement_concept_code varchar \"OMOP standard concept code\"\n        measurement_concept_name varchar \"OMOP standard concept name\"\n        vocabulary_id varchar \"OMOP standard vocabulary\" \n        measurement_type_concept_id integer \"OMOP provenance/type of measurement\" \n        measurement_type_concept_name integer \"OMOP provenance/type of measurement as text\"   \n        measurement_location varchar \"free text for location context - e.g. ward name, or inpatient, outpatient, TTA\"\n        operator_concept_id integer \"OMOP standard concept id, omission here is equivalent to '='\"\n        operator_concept_name varchar \"OMOP operator name for visibility\"         \n        value_as_number float \"numerical value of the result of the measurement\"\n        value_as_concept_id integer \"OMOP concept id to represent specific categorical values in Meas Value domain\"\n        value_as_categorical varchar \"categorical results\"\n        unit_concept_id integer \"OMOP concept id to represent unit of measurement\"\n        unit_concept_name varchar \"OMOP unit name for visibility\"\n        range_low float \"normal range low\"\n        range_high float  \"normal range high\"\n        range_unit varchar \"range units\"           \n        measurement_source_value varchar \"measurement code as represented in source\"\n        measurement_source_value_name varchar \"measurement name as represented in source\"\n        value_source_value varchar \"verbatim value as described in source\"\n        visit_occurrence_id integer \"[FK ext_visit_occurrence] standardised unique visit id\"\n        source_table_provenance varchar \"source table name\"\n        source_row_id uuid \"unique row id for the single concept that is generated at ingestion\"\n    }\n\n\n\n\n\n\n\n\n\nThe MEASUREMENT table contains records of Measurements, i.e. structured values (numerical or categorical) obtained through systematic and standardized examination or testing of a Person or Person’s sample. The MEASUREMENT table contains both orders and results of such Measurements as laboratory tests, vital signs, quantitative findings from pathology reports, etc. Measurements are stored as attribute value pairs, with the attribute as the Measurement Concept and the value representing the result. The value can be a Concept (stored in VALUE_AS_CONCEPT), or a numerical value (VALUE_AS_NUMBER) with a Unit (UNIT_CONCEPT_ID). Measurements differ from Observations in that they require a standardized test or some other activity to generate a quantitative or qualitative result. If there is no result, it is assumed that the lab test was conducted but the result was not captured.\n\n\n\n\n\n---\ntitle: OMOP.MEASUREMENT\n---\nerDiagram\n    MEASUREMENT {\n        measurement_id integer \"[PK not null] autogenerated identifier\"\n        person_id integer \"[FK not null]\"\n        measurement_concept_id integer \"[not null] standard OMOP concept id used for analyses\"\n        measurement_date date \"[not null]\"\n        measurement_datetime datetime\n        measurement_time timestamp\n        measurement_type_concept_id integer \"[not null] provenance of measurement value per OMOP\"\n        operator_concept_id integer \"omission here is equivalent to '='\"         \n        value_as_number float \"numerical value of the result of the measurement\"\n        value_as_concept_id integer \"standard concept result for categorical values in Meas Value domain\"\n        unit_concept_id integer\n        range_low float\n        range_high float\n        provider_id integer \"[FK] clinician provider who recorded condition\"\n        visit_occurrence_id integer \"[FK]\"\n        visit_detail_id integer \"[FK]\"\n        measurement_source_value varchar50 \"concept code as represented in source\"\n        measurement_source_concept_id integer \"source mapped to omop but often left empty\"\n        unit_source_value varchar50 \"verbatim unit given in source\"\n        unit_source_concept_id integer \"source unit mapped to omop\"\n        value_source_value varchar50 \"verbatim result value of the measurement in source\"\n        measurement_event_id integer \"link to a related record in the db\"\n        meas_event_field_concept_id integer \"concept id identifying the TABLE that is linked\"\n    }\n\n\n\n\n\n\n\n\n\nNone for now!\n\n\n\nNone for now!",
    "crumbs": [
      "COMMON DATA MODEL",
      "Table/MEASUREMENT"
    ]
  },
  {
    "objectID": "pages/data_pipeline/intro.html",
    "href": "pages/data_pipeline/intro.html",
    "title": "London SDE/AIC Technical Documentation",
    "section": "",
    "text": "This section describes the architecture of our hospital data pipelines.\n\n\n\n\n\n%%{init: {'theme': 'neutral' } }%%\n  flowchart LR\n\n    A[\"SOURCE\"]--\"Batch/stream to landing zone \n                    and load to database\"--&gt;B[\"BRONZE\"]--\"Standardise structure \n                                                          and concepts\"--&gt;C[\"SILVER\"]--\"OMOP conversion and\n                                                                                        analytics mart creation\"--&gt;D[\"GOLD\"]\n\n\n\n\n\n\n[placeholder]",
    "crumbs": [
      "DATA PIPELINE",
      "Intro to Pipeline"
    ]
  },
  {
    "objectID": "pages/data_pipeline/intro.html#introduction",
    "href": "pages/data_pipeline/intro.html#introduction",
    "title": "London SDE/AIC Technical Documentation",
    "section": "",
    "text": "This section describes the architecture of our hospital data pipelines.\n\n\n\n\n\n%%{init: {'theme': 'neutral' } }%%\n  flowchart LR\n\n    A[\"SOURCE\"]--\"Batch/stream to landing zone \n                    and load to database\"--&gt;B[\"BRONZE\"]--\"Standardise structure \n                                                          and concepts\"--&gt;C[\"SILVER\"]--\"OMOP conversion and\n                                                                                        analytics mart creation\"--&gt;D[\"GOLD\"]\n\n\n\n\n\n\n[placeholder]",
    "crumbs": [
      "DATA PIPELINE",
      "Intro to Pipeline"
    ]
  },
  {
    "objectID": "pages/data_model/intro.html",
    "href": "pages/data_model/intro.html",
    "title": "London SDE/AIC Technical Documentation",
    "section": "",
    "text": "This section explains how we model clinical data across our partner hospitals.\n\n\nNHS hospitals generate vast amounts of electronic data, but it’s often unsuitable for immediate analytics or research due to normalisation, transactional design, and inconsistencies across systems. To unify data from various sources, it must be transformed into a Common Data Model (CDM). Extensive transformation risks changing meaning or introducing errors, potentially impacting research outcomes or patient care decisions. This is particularly critical for high-stakes applications like regulatory drug assessments or AI model training for precision medicine. Consequently, we follow strict guidelines to maintain data integrity and trustworthiness throughout our pipelines:\n\n\n\n\n\n\nAvoid information loss\n\n\n\nFor a given domain of interest, the target data model should not result in any relevant information being discarded.\n\n\n\n\n\n\n\n\nContinuously enrich with metadata\n\n\n\nInformation should be added to enrich contextual understanding of each data item, which can be surfaced to inform analytical decisions.\n\n\n\n\n\n\n\n\nKeep data provenance visible\n\n\n\nEach value or concept, even after transformations, should be traceable back to the source system/table where it was originally generated.\n\n\n\n\n\n\n\n\nConsider source systems and context as part of the data pipeline\n\n\n\nSource systems and context affect the meaning of data, and while they fall outside control or assurance of engineers, they must be comprehensively documented for data to be interpretable during analysis.\n\n\n\n\n\n\n\n\nKeep data lineage traceable back to source\n\n\n\nThis includes any transformations to numerical values or concepts, and is essential for trust in standardised data. Transformed data should be easily comparable to its source appearance.\n\n\n\n\n\n\n\n\nMake ‘research-ready’ only for each use-case\n\n\n\nData is kept close to source while being made interoperable, and more extensive transformations are performed only on the basis of study requirements. In particular, handling of data quality issues should be a decision made at analysis, dependant on type of analysis.\n\n\nThese guidelines ensure that data is kept as close to its original form for as long as possible, whilst creating syntactic and semantic standardisation, and introducing full visibility over sources and transformations.\n\n\n\nThe Observational Medical Outcomes Partnership (OMOP) Common Data Model (CDM) standardises medical data for large-scale analytics and cross-site research. It organizes data into standardised tables and uses consistent vocabulary, enabling syntactic and semantic interoperability, with key advantages:\n\n\n\n\n\n\n1. International standard: wide adoption and support has made OMOP the de facto international standard common data model for research\n\n\n2. Reproducibility: easier code-sharing and reproduction of research findings across different datasets\n\n\n3. Federated analytics: the same code can be directly executed without modification across different sites, with results combined\n\n\n\n\n\n\nOMOP CDM 5.4\n\n\nHowever, OMOP also has limitations:\n\n\n\n\n\n\n1. Data model is USA-centric and has elements that are not applicable to other countries, e.g. representation of race and ethnicity\n\n\n2. Standard vocabulary may not capture how standard ontologies are used and updated in other countries, e.g. NHS/UK SNOMED extensions and use of dm+d\n\n\n3. Rigid structure means there is potential information loss during conversion where data, especially of variable quality, must be ‘forced’ into the model\n\n\n4. Different interpretations of how to convert (e.g. choice of source systems, local mappings) may result in OMOP at different sites having varying meaning, unless precise conventions for a particular cohort are agreed in advance\n\n\n5. Limited number of fields prevents additional data types or complex medical concepts, e.g. NHS specific qualifiers, and makes it difficult to incorporate new types of data or emerging medical concepts such as genomics and cancer, without workarounds\n\n\n6. Representing complex temporal relationships and hierarchical/nested episodes, e.g. cancer pathways, is challenging\n\n\n7. Limited ability for capturing data provenance, and USA-centric source system classification\n\n\n8. OMOP is not able to handle dimensions of patients that change over time, without using workarounds\n\n\n\nFor our work, OMOP serves as a target model for specific cohorts that require interoperable data across multiple sites (i.e. a data mart / GOLD layer in a medallion architecture). However, due to its limitations, OMOP breaks our data modelling guidelines and is not used as a primary CDM. Rather, we adopt a wider data model, which we refer to as OMOP Extended (OMOP-EXT CDM), serving as the SILVER layer.\n\n\n\nOMOP-EXT is made to be compatible with OMOP, but adds additional columns for greater semantic capture, and better localisation. Compatibility is defined as the following:\n\n\n\n\n\n\n1. All concepts are mapped to concepts recognised by the OMOP vocabulary, and to OMOP standard concepts whereever possible. Semantic layer uses OMOP defined concept IDs as primary keys\n\n\n2. Fields from OMOP CDM are included as part of OMOP-EXT whereever there is information routinely available to populate them. Fields are used identically to OMOP CDM\n\n\n3. No additional fields are introduced if similar fields or functions already exist in OMOP CDM\n\n\n\nThe resulting SILVER stage is designed to be ‘one transformation step’ away from OMOP GOLD tables, where decisions on patient inclusion and data cleaning are executed.\n\n\n\nOMOP provides different ways for representing provenance. These include using concepts that represent the type of data source, and concepts that represent the concept status. “Type” is USA-centric and does not carry granularity to represent the specific types of NHS system (though NHS systems can be mapped to these categories). Concept status is specific to the context in which each condition code was recorded. In practice, this type of metadata is rarely present in NHS source data, and would usually be inferred by the source system.\nIn the Common Data Model, SILVER tables therefore include additional columns to enable visibility over the source table, and NHS source system, and the direct relationship to a row in a source table via a unique source_row_id that is generated at data load. This also enables direct visbility over changes made during transformation.\n\n\n\n[placeholder]",
    "crumbs": [
      "COMMON DATA MODEL",
      "Intro to CDM"
    ]
  },
  {
    "objectID": "pages/data_model/intro.html#introduction",
    "href": "pages/data_model/intro.html#introduction",
    "title": "London SDE/AIC Technical Documentation",
    "section": "",
    "text": "This section explains how we model clinical data across our partner hospitals.\n\n\nNHS hospitals generate vast amounts of electronic data, but it’s often unsuitable for immediate analytics or research due to normalisation, transactional design, and inconsistencies across systems. To unify data from various sources, it must be transformed into a Common Data Model (CDM). Extensive transformation risks changing meaning or introducing errors, potentially impacting research outcomes or patient care decisions. This is particularly critical for high-stakes applications like regulatory drug assessments or AI model training for precision medicine. Consequently, we follow strict guidelines to maintain data integrity and trustworthiness throughout our pipelines:\n\n\n\n\n\n\nAvoid information loss\n\n\n\nFor a given domain of interest, the target data model should not result in any relevant information being discarded.\n\n\n\n\n\n\n\n\nContinuously enrich with metadata\n\n\n\nInformation should be added to enrich contextual understanding of each data item, which can be surfaced to inform analytical decisions.\n\n\n\n\n\n\n\n\nKeep data provenance visible\n\n\n\nEach value or concept, even after transformations, should be traceable back to the source system/table where it was originally generated.\n\n\n\n\n\n\n\n\nConsider source systems and context as part of the data pipeline\n\n\n\nSource systems and context affect the meaning of data, and while they fall outside control or assurance of engineers, they must be comprehensively documented for data to be interpretable during analysis.\n\n\n\n\n\n\n\n\nKeep data lineage traceable back to source\n\n\n\nThis includes any transformations to numerical values or concepts, and is essential for trust in standardised data. Transformed data should be easily comparable to its source appearance.\n\n\n\n\n\n\n\n\nMake ‘research-ready’ only for each use-case\n\n\n\nData is kept close to source while being made interoperable, and more extensive transformations are performed only on the basis of study requirements. In particular, handling of data quality issues should be a decision made at analysis, dependant on type of analysis.\n\n\nThese guidelines ensure that data is kept as close to its original form for as long as possible, whilst creating syntactic and semantic standardisation, and introducing full visibility over sources and transformations.\n\n\n\nThe Observational Medical Outcomes Partnership (OMOP) Common Data Model (CDM) standardises medical data for large-scale analytics and cross-site research. It organizes data into standardised tables and uses consistent vocabulary, enabling syntactic and semantic interoperability, with key advantages:\n\n\n\n\n\n\n1. International standard: wide adoption and support has made OMOP the de facto international standard common data model for research\n\n\n2. Reproducibility: easier code-sharing and reproduction of research findings across different datasets\n\n\n3. Federated analytics: the same code can be directly executed without modification across different sites, with results combined\n\n\n\n\n\n\nOMOP CDM 5.4\n\n\nHowever, OMOP also has limitations:\n\n\n\n\n\n\n1. Data model is USA-centric and has elements that are not applicable to other countries, e.g. representation of race and ethnicity\n\n\n2. Standard vocabulary may not capture how standard ontologies are used and updated in other countries, e.g. NHS/UK SNOMED extensions and use of dm+d\n\n\n3. Rigid structure means there is potential information loss during conversion where data, especially of variable quality, must be ‘forced’ into the model\n\n\n4. Different interpretations of how to convert (e.g. choice of source systems, local mappings) may result in OMOP at different sites having varying meaning, unless precise conventions for a particular cohort are agreed in advance\n\n\n5. Limited number of fields prevents additional data types or complex medical concepts, e.g. NHS specific qualifiers, and makes it difficult to incorporate new types of data or emerging medical concepts such as genomics and cancer, without workarounds\n\n\n6. Representing complex temporal relationships and hierarchical/nested episodes, e.g. cancer pathways, is challenging\n\n\n7. Limited ability for capturing data provenance, and USA-centric source system classification\n\n\n8. OMOP is not able to handle dimensions of patients that change over time, without using workarounds\n\n\n\nFor our work, OMOP serves as a target model for specific cohorts that require interoperable data across multiple sites (i.e. a data mart / GOLD layer in a medallion architecture). However, due to its limitations, OMOP breaks our data modelling guidelines and is not used as a primary CDM. Rather, we adopt a wider data model, which we refer to as OMOP Extended (OMOP-EXT CDM), serving as the SILVER layer.\n\n\n\nOMOP-EXT is made to be compatible with OMOP, but adds additional columns for greater semantic capture, and better localisation. Compatibility is defined as the following:\n\n\n\n\n\n\n1. All concepts are mapped to concepts recognised by the OMOP vocabulary, and to OMOP standard concepts whereever possible. Semantic layer uses OMOP defined concept IDs as primary keys\n\n\n2. Fields from OMOP CDM are included as part of OMOP-EXT whereever there is information routinely available to populate them. Fields are used identically to OMOP CDM\n\n\n3. No additional fields are introduced if similar fields or functions already exist in OMOP CDM\n\n\n\nThe resulting SILVER stage is designed to be ‘one transformation step’ away from OMOP GOLD tables, where decisions on patient inclusion and data cleaning are executed.\n\n\n\nOMOP provides different ways for representing provenance. These include using concepts that represent the type of data source, and concepts that represent the concept status. “Type” is USA-centric and does not carry granularity to represent the specific types of NHS system (though NHS systems can be mapped to these categories). Concept status is specific to the context in which each condition code was recorded. In practice, this type of metadata is rarely present in NHS source data, and would usually be inferred by the source system.\nIn the Common Data Model, SILVER tables therefore include additional columns to enable visibility over the source table, and NHS source system, and the direct relationship to a row in a source table via a unique source_row_id that is generated at data load. This also enables direct visbility over changes made during transformation.\n\n\n\n[placeholder]",
    "crumbs": [
      "COMMON DATA MODEL",
      "Intro to CDM"
    ]
  },
  {
    "objectID": "pages/data_model/cdm_condition_occurrence.html",
    "href": "pages/data_model/cdm_condition_occurrence.html",
    "title": "London SDE/AIC Technical Documentation",
    "section": "",
    "text": "Structured data sources for patient diagnoses, and observed signs and notable symptoms will generally always include:\n\n\n\nTable\nType\n\n\n\n\nCommissioning Datasets\nLegacy + Live\n\n\nClinical Coding activity outputs\nLegacy + Live\n\n\nElectronic health record system problem lists\nLegacy + Live\n\n\n\nTables are loaded to the database in batches, or through incremental ingestion via connection to a source database.\n\n\n\nData sources are staged as stg_{source}__{entity} (if necessary, with an initial step of base_{source}__{entity} prior to unioning). This may include column renaming and edge case handling.\n\n\n\nDifferent data sources are UNIONED into a minimum common dataset for representing the occurrence of conditions, and attached, relevant qualifiers. This table does not contain data from specialty systems such as cancer, which may have additional diagnostic qualifiers.\nDiagnosis codes are attached to a particular patient. Patients must first be assigned a person_uuid, which is given to the relevant diagnosis in this intermediate stage.\nDiagnosis codes may be attached to a particular hospital admission or attendance. These spells or attendances must first be assigned a visit_occurrence_id, which is given to the relevant diagnosis.\n\n\n\n\n\n---\ntitle: Condition Occurrence Intermediate Table\n---\nerDiagram\n    int_condition_occurrence {\n        condition_occurrence_id integer \"[PK] autogenerated identifier\"\n        person_uuid uuid \"[FK ext_person] standardised unique person id\"\n        condition_start_date date\n        condition_start_datetime datetime\n        condition_end_date date\n        condition_end_datetime datetime        \n        condition_source_value varchar \"condition code as represented in source\"\n        condition_source_value_name varchar \"condition name as represented in source\"\n        domain_id varchar \"most relevant omop domain\"\n        source_vocabulary_id varchar \"id of source vocab\"\n        condition_diagnosis_order integer \"used where diagnoses are ordered, e.g. in commissioning data\"\n        stop_reason varchar \"where given\"\n        visit_occurrence_id integer \"[FK ext_visit_occurrence] standardised unique visit id\"\n        source_table_provenance varchar \"[NEW] source table name\"\n        source_row_id uuid \"unique row id for the single concept that is generated at ingestion\"\n    }\n\n\n\n\n\n\n\n\n\nThis is the transformed version of ingested condition tables. Concepts in this table are mapped to OMOP standards, and column naming is compatible, but it contains the following differences:\n\nStandardised concept codes/names are surfaced, and indexed, to enable user-friendly exploration and visualisation without the need for large joins;\nOMOP CDM 5.4 columns that are not relevant to the NHS, or to intended purposes, are excluded. When converting to vanilla OMOP, these columns remain empty;\nSource, table, and systems provenance are maintained;\nSystems source is mapped to condition_type_concept_id per OMOP.\n\n\n\n\n\n\n---\ntitle: OMOP_EXT Condition Occurrence\n---\nerDiagram\n    ext_condition_occurrence {\n        condition_occurrence_id integer \"[PK] autogenerated identifier\"\n        person_uuid uuid \"[FK ext_person] standardised unique person id\"\n        condition_start_date date\n        condition_start_datetime timestamp\n        condition_end_date date\n        condition_end_datetime timestamp\n        condition_concept_id integer \"OMOP standard concept id\"\n        condition_concept_code varchar \"OMOP standard concept code\"\n        condition_concept_name varchar \"OMOP standard concept name\"\n        vocabulary_id varchar \"OMOP standard vocabulary\"\n        condition_type_concept_id integer \"OMOP provenance/type of condition\" \n        condition_type_concept_name integer \"OMOP provenance/type of condition as text\"                          \n        condition_diagnosis_order integer \"used where diagnoses are ordered, e.g. in commissioning data\"\n        stop_reason varchar \"where given\"\n        visit_occurrence_id integer \"[FK ext_visit_occurrence] standardised unique visit id\"\n        condition_source_value varchar \"condition code as represented in source\"\n        condition_source_value_name varchar \"condition name as represented in source\"        \n        source_table_provenance varchar \"source table name\"\n        source_row_id uuid \"unique row id for the single concept that is generated at ingestion\"\n    }\n\n\n\n\n\n\n\n\n\nThis table contains records of Events of a Person suggesting the presence of a disease or medical condition stated as a diagnosis, a sign, or a symptom, which is either observed by a Provider or reported by the patient. The canonical OMOP table is shown below.\n\n\n\n\n\n---\ntitle: OMOP Condition Occurrence\n---\nerDiagram\n    condition_occurrence {\n        condition_occurrence_id integer \"[PK not null] autogenerated identifier\"\n        person_id integer \"[FK not null]\"\n        condition_concept_id integer \"[not null] standard OMOP concept id used for analyses\"\n        condition_start_date date \"[not null]\"\n        condition_start_datetime timestamp\n        condition_end_date date\n        condition_end_datetime timestamp\n        condition_type_concept_id integer \"[not null] provenance of condition record per OMOP - see notes\"\n        condition_status_concept_id integer \"how diagnosis was made - e.g. admission vs final\"\n        stop_reason varchar20 \"why condition is no longer valid\"\n        provider_id integer \"[FK] clinician provider who recorded condition\"\n        visit_occurrence_id integer \"[FK]\"\n        visit_detail_id integer \"[FK]\"\n        condition_source_value varchar50 \"condition code as represented in source\"\n        condition_source_concept_id integer \"mapping to omop but often left empty\"\n        condition_status_source_value varchar50 \"condition status as represented in source\"\n    }\n\n\n\n\n\n\n\n\n\nNone for now!\n\n\n\nNone for now!",
    "crumbs": [
      "COMMON DATA MODEL",
      "Table/CONDITION_OCCURRENCE"
    ]
  },
  {
    "objectID": "pages/data_model/cdm_condition_occurrence.html#condition_occurrence",
    "href": "pages/data_model/cdm_condition_occurrence.html#condition_occurrence",
    "title": "London SDE/AIC Technical Documentation",
    "section": "",
    "text": "Structured data sources for patient diagnoses, and observed signs and notable symptoms will generally always include:\n\n\n\nTable\nType\n\n\n\n\nCommissioning Datasets\nLegacy + Live\n\n\nClinical Coding activity outputs\nLegacy + Live\n\n\nElectronic health record system problem lists\nLegacy + Live\n\n\n\nTables are loaded to the database in batches, or through incremental ingestion via connection to a source database.\n\n\n\nData sources are staged as stg_{source}__{entity} (if necessary, with an initial step of base_{source}__{entity} prior to unioning). This may include column renaming and edge case handling.\n\n\n\nDifferent data sources are UNIONED into a minimum common dataset for representing the occurrence of conditions, and attached, relevant qualifiers. This table does not contain data from specialty systems such as cancer, which may have additional diagnostic qualifiers.\nDiagnosis codes are attached to a particular patient. Patients must first be assigned a person_uuid, which is given to the relevant diagnosis in this intermediate stage.\nDiagnosis codes may be attached to a particular hospital admission or attendance. These spells or attendances must first be assigned a visit_occurrence_id, which is given to the relevant diagnosis.\n\n\n\n\n\n---\ntitle: Condition Occurrence Intermediate Table\n---\nerDiagram\n    int_condition_occurrence {\n        condition_occurrence_id integer \"[PK] autogenerated identifier\"\n        person_uuid uuid \"[FK ext_person] standardised unique person id\"\n        condition_start_date date\n        condition_start_datetime datetime\n        condition_end_date date\n        condition_end_datetime datetime        \n        condition_source_value varchar \"condition code as represented in source\"\n        condition_source_value_name varchar \"condition name as represented in source\"\n        domain_id varchar \"most relevant omop domain\"\n        source_vocabulary_id varchar \"id of source vocab\"\n        condition_diagnosis_order integer \"used where diagnoses are ordered, e.g. in commissioning data\"\n        stop_reason varchar \"where given\"\n        visit_occurrence_id integer \"[FK ext_visit_occurrence] standardised unique visit id\"\n        source_table_provenance varchar \"[NEW] source table name\"\n        source_row_id uuid \"unique row id for the single concept that is generated at ingestion\"\n    }\n\n\n\n\n\n\n\n\n\nThis is the transformed version of ingested condition tables. Concepts in this table are mapped to OMOP standards, and column naming is compatible, but it contains the following differences:\n\nStandardised concept codes/names are surfaced, and indexed, to enable user-friendly exploration and visualisation without the need for large joins;\nOMOP CDM 5.4 columns that are not relevant to the NHS, or to intended purposes, are excluded. When converting to vanilla OMOP, these columns remain empty;\nSource, table, and systems provenance are maintained;\nSystems source is mapped to condition_type_concept_id per OMOP.\n\n\n\n\n\n\n---\ntitle: OMOP_EXT Condition Occurrence\n---\nerDiagram\n    ext_condition_occurrence {\n        condition_occurrence_id integer \"[PK] autogenerated identifier\"\n        person_uuid uuid \"[FK ext_person] standardised unique person id\"\n        condition_start_date date\n        condition_start_datetime timestamp\n        condition_end_date date\n        condition_end_datetime timestamp\n        condition_concept_id integer \"OMOP standard concept id\"\n        condition_concept_code varchar \"OMOP standard concept code\"\n        condition_concept_name varchar \"OMOP standard concept name\"\n        vocabulary_id varchar \"OMOP standard vocabulary\"\n        condition_type_concept_id integer \"OMOP provenance/type of condition\" \n        condition_type_concept_name integer \"OMOP provenance/type of condition as text\"                          \n        condition_diagnosis_order integer \"used where diagnoses are ordered, e.g. in commissioning data\"\n        stop_reason varchar \"where given\"\n        visit_occurrence_id integer \"[FK ext_visit_occurrence] standardised unique visit id\"\n        condition_source_value varchar \"condition code as represented in source\"\n        condition_source_value_name varchar \"condition name as represented in source\"        \n        source_table_provenance varchar \"source table name\"\n        source_row_id uuid \"unique row id for the single concept that is generated at ingestion\"\n    }\n\n\n\n\n\n\n\n\n\nThis table contains records of Events of a Person suggesting the presence of a disease or medical condition stated as a diagnosis, a sign, or a symptom, which is either observed by a Provider or reported by the patient. The canonical OMOP table is shown below.\n\n\n\n\n\n---\ntitle: OMOP Condition Occurrence\n---\nerDiagram\n    condition_occurrence {\n        condition_occurrence_id integer \"[PK not null] autogenerated identifier\"\n        person_id integer \"[FK not null]\"\n        condition_concept_id integer \"[not null] standard OMOP concept id used for analyses\"\n        condition_start_date date \"[not null]\"\n        condition_start_datetime timestamp\n        condition_end_date date\n        condition_end_datetime timestamp\n        condition_type_concept_id integer \"[not null] provenance of condition record per OMOP - see notes\"\n        condition_status_concept_id integer \"how diagnosis was made - e.g. admission vs final\"\n        stop_reason varchar20 \"why condition is no longer valid\"\n        provider_id integer \"[FK] clinician provider who recorded condition\"\n        visit_occurrence_id integer \"[FK]\"\n        visit_detail_id integer \"[FK]\"\n        condition_source_value varchar50 \"condition code as represented in source\"\n        condition_source_concept_id integer \"mapping to omop but often left empty\"\n        condition_status_source_value varchar50 \"condition status as represented in source\"\n    }\n\n\n\n\n\n\n\n\n\nNone for now!\n\n\n\nNone for now!",
    "crumbs": [
      "COMMON DATA MODEL",
      "Table/CONDITION_OCCURRENCE"
    ]
  },
  {
    "objectID": "pages/data_model/cdm_drug_exposure.html",
    "href": "pages/data_model/cdm_drug_exposure.html",
    "title": "London SDE/AIC Technical Documentation",
    "section": "",
    "text": "Structured data sources for medications prescribing and dispensing will generally always include:\n\n\n\n\n\n\n\nTable\nType\n\n\n\n\nElectronic prescribing and administration\nLegacy + Live\n\n\nPharmacy dispensing\nLegacy + Live\n\n\n\nTables are loaded to the database in batches, or through incremental ingestion via connection to a source database.\n\n\n\nData sources are staged as stg_{source}__{entity} (if necessary, with an initial step of base_{source}__{entity} prior to unioning). This may include column renaming and edge case handling.\n\n\n\nDifferent data sources are UNIONED into a common dataset for representing medications that are dispensed from pharmacy to inpatient, outpatient, and to-take-away. This table does not contain data from specialty specific systems such as chemotherapy.\nPatients must first be assigned a person_uuid. Where dispensing is attached to a particular hospital admission or attendance, these spells or attendances must first be assigned a visit_occurrence_id.\nThe column drug_type helps interpretation, and will indirectly map to OMOP drug_type_concept_id: - dispensing_unknown indicates a drug that was ordered for dispensing from pharmacy, but the data source does not provide information to indicate whether this dispensing was carried out; - dispensing_dispensed indicates a drug that was ordered and dispensed to patient from pharmacy; - dispensing_notdispensed indicates a drug that was ordered for dispensing, but ultimately not dispensed.\nThis table gives flexibility for highly detailed source systems, including possiblities for recording formulations and prescribed doses and instructions for each drug.\n\n\n\n\n\n---\ntitle: Drug Exposure (Dispensing) Intermediate Table\n---\nerDiagram\n    int_drug_exposure_dispensing {\n        drug_exposure_id integer \"[PK] autogenerated identifier\"\n        person_uuid uuid \"[FK ext_person] standardised unique person id\"\n        drug_exposure_start_date date\n        drug_exposure_start_datetime datetime\n        drug_exposure_end_date date\n        drug_exposure_end_datetime datetime        \n        drug_source_value varchar \"drug code as represented in source\"\n        drug_source_value_name varchar \"drug name as represented in source - may include formulation\"\n        domain_id varchar \"most relevant omop domain\"\n        source_vocabulary_id varchar \"id of source vocab\"\n        drug_type varchar \"status of drug, dispensing_unknown, dispensing_dispensed, dispensing_notdispensed\"\n        drug_location varchar \"free text for location context - e.g. ward name, or inpatient, outpatient, TTA\"\n        drug_desc varchar \"additional free text for further qualification, e.g. resupply, new supply\"\n        route_source_value varchar \"route as represented in the source\"\n        item_formulation_source_value varchar \"if available, best string that fully describes item formulation, e.g. 500mg tablet\"\n        item_strength_quantity_source_value float \"strength of one item of drug e.g. 500\"\n        item_strength_units_source_value varchar \"units given to one item e.g. mg\"        \n        item_type_source_value varchar \"type of item, e.g. tablet\"\n        dose_instruct_source_value varchar \"if available, best string that captures dosing instructions, e.g. 1g four times a day\"\n        dose_quantity_source_value float \"dose prescribed e.g. 1\"\n        dose_unit_source_value varchar \"units given to the prescribed dose e.g. g\"\n        dose_frequency_source_value varchar \"dosing instructions e.g. four times a day\"\n        days_supply integer \"how many days given\"\n        stop_reason varchar \"stop reason where given in source\"\n        sig varchar \"additional verbatim instructions for drug\"\n        visit_occurrence_id integer \"[FK ext_visit_occurrence] standardised unique visit id\"\n        source_table_provenance varchar \"source table name\"\n        source_row_id uuid \"unique row id for the single concept that is generated at ingestion\"\n    }\n\n\n\n\n\n\n\n\n\nDifferent data sources are UNIONED into a common dataset for representing medications that are prescribed +/- administered while attending a hospital location. This table does not contain data from specialty specific systems such as chemotherapy.\nPatients must first be assigned a person_uuid. Where dispensing is attached to a particular hospital admission or attendance, these spells or attendances must first be assigned a visit_occurrence_id.\nThe column drug_type helps interpretation, and will indirectly map to OMOP drug_type_concept_id: - prescribing_unknown indicates a drug that was prescribed, but the data source does not provide information to indicate whether the drug was administered or not - prescribing_administered indicates that a drug was prescribed and administered to the patient - presribing_notadministered indicates that a drug was prescribed but was explicitly cancelled or otherwise not given\nThis table also gives flexiblity for inputting special prescription/administration types, such as infusions.\n\n\n\n\n\n---\ntitle: Drug Exposure (Prescribing) Intermediate Table\n---\nerDiagram\n    int_drug_exposure_prescribing {\n        drug_exposure_id integer \"[PK] autogenerated identifier\"\n        person_uuid uuid \"[FK ext_person] standardised unique person id\"\n        drug_exposure_start_date date\n        drug_exposure_start_datetime datetime\n        drug_exposure_end_date date\n        drug_exposure_end_datetime datetime        \n        drug_source_value varchar \"drug code as represented in source\"\n        drug_source_value_name varchar \"drug name as represented in source - may include formulation\"\n        domain_id varchar \"most relevant omop domain\"\n        source_vocabulary_id varchar \"id of source vocab\"\n        drug_type varchar \"status of drug, prescribing_unknown, prescribing_administered, prescribing_notadministered\"\n        drug_location varchar \"free text for location context - e.g. ward name or clinic name\"\n        drug_desc varchar \"additional free text for further qualification, e.g. patient refused\"\n        route_source_value varchar \"route as represented in the source\"\n        item_formulation_source_value varchar \"best string that fully describes item formulation, particularly infusions: e.g. 10mg/ml propofol emulsion\"       \n        item_type_source_value varchar \"type of item, e.g. emulsion\"        \n        dose_instruct_source_value varchar \"best string that captures dosing, e.g. 100mg\"\n        dose_quantity_source_value float \"dose prescribed e.g. 100\"\n        dose_unit_source_value varchar \"units given to the prescribed dose e.g. mg\"\n        dose_frequency_source_value varchar \"dosing instructions e.g. once stat\"\n        infusion_rate_source_value varchar \"rate of infusion between start_datetime and end_datetime\"\n        infusion_rate_quantity_source_value float \"rate of infusion as number\"\n        infusion_rate_unit_source_value varchar \"rate of infusion units\"\n        stop_reason varchar \"stop reason where given in source\"\n        sig varchar \"additional verbatim instructions for drug\"\n        visit_occurrence_id integer \"[FK ext_visit_occurrence] standardised unique visit id\"\n        source_table_provenance varchar \"source table name\"\n        source_row_id uuid \"unique row id for the single concept that is generated at ingestion\"\n    }\n\n\n\n\n\n\n\n\n\nThis is the transformed version of ingested drug_exposure tables. It includes dispensing and administration (specified through drug_type). Concepts in this table are mapped to OMOP standards, and column naming is compatible, but it contains the following differences:\n\nMappings are made to OMOP at same granularity as original source value, as well as to the drug ingredient(s);\nMapping is made by default to dm+d due to NHS/UK origin, with further mapping to RxNorm when transforming to vanilla OMOP;\nStandardised concept codes/names are surfaced, and indexed, to enable user-friendly exploration and visualisation without the need for large joins;\nOMOP CDM 5.4 columns that are not relevant to the NHS, or to intended purposes, are excluded. When converting to vanilla OMOP, these columns remain empty;\nSource, table, and systems provenance are maintained, and closest provenance type is mapped to drug_type_concept_id per OMOP;\nGreater granularity in strength, dose, and infusion characteristics are allowed.\n\n\n\n\n\n\n---\ntitle: OMOP_EXT Drug Exposure\n---\nerDiagram\n    ext_drug_exposure {\n        drug_exposure_id integer \"[PK] autogenerated identifier\"\n        person_uuid uuid \"[FK ext_person] standardised unique person id\"\n        drug_exposure_start_date date\n        drug_exposure_start_datetime datetime\n        drug_exposure_end_date date\n        drug_exposure_end_datetime datetime  \n        drug_concept_id integer \"OMOP standard concept id\"\n        drug_concept_code varchar \"OMOP standard concept code\"\n        drug_concept_name varchar \"OMOP standard concept name\"\n        drug_vocabulary_id varchar \"OMOP standard vocabulary\" \n        drug_ingredient_concept_id integer \"OMOP standard concept id for ingredient(s)\"\n        drug_ingredient_concept_code varchar \"OMOP standard concept code for ingredient(s)\"\n        drug_ingredient_concept_name varchar \"OMOP standard concept name for ingredient(s)\"            \n        drug_ingredient_vocabulary_id varchar \"OMOP standard vocabulary for ingredient(s)\"\n        drug_type_concept_id integer \"OMOP classification for type of drug record\"                   \n        drug_type varchar \"status of drug - see previous notes\"\n        drug_location varchar \"free text for location context\"\n        drug_desc varchar \"additional free text for further qualification\"\n        route_concept_id integer \"OMOP standard concept id for route\"\n        route_concept_name varchar \"OMOP standard concept name for route\"\n        item_formulation_source_value varchar \"if available, best string that fully describes strength/formulation/concentration\"\n        item_strength_quantity_source_value float \"strength of one item of drug e.g. 500\"\n        item_strength_units_source_value varchar \"units given to one item e.g. mg\"        \n        item_type_source_value varchar \"type of item, e.g. tablet\"\n        dose_instruct_source_value varchar \"if available, best string that captures dosing instructions, e.g. 1g four times a day\"\n        dose_quantity_source_value float \"dose prescribed e.g. 1\"\n        dose_unit_source_value varchar \"units given to the prescribed dose e.g. g\"\n        dose_frequency_source_value varchar \"dosing instructions e.g. four times a day\"\n        infusion_rate_source_value varchar \"if available, best string that captures rate of infusion between start_datetime and end_datetime\"\n        infusion_rate_quantity_source_value float \"rate of infusion as number\"\n        infusion_rate_unit_source_value varchar \"rate of infusion units\"\n        days_supply integer \"how many days supply dispensed\"\n        stop_reason varchar \"stop reason where given in source\"\n        sig varchar \"additional verbatim instructions for drug\"\n        visit_occurrence_id integer \"[FK ext_visit_occurrence] standardised unique visit id\"\n        drug_source_value varchar \"drug code as represented in source\"\n        drug_source_value_name varchar \"drug name as represented in source - may include formulation\"     \n        route_source_value varchar \"route as represented in the source\"           \n        source_table_provenance varchar \"source table name\"\n        source_row_id uuid \"unique row id for the single concept that is generated at ingestion\"\n    }\n\n\n\n\n\n\n\n\n\nThis table captures records about the exposure to a Drug ingested or otherwise introduced into the body. A Drug is a biochemical substance formulated in such a way that when administered to a Person it will exert a certain biochemical effect on the metabolism. Drugs include prescription and over-the-counter medicines, vaccines, and large-molecule biologic therapies. Radiological devices ingested or applied locally do not count as Drugs.\n\n\n\n\n\n---\ntitle: OMOP Drug Exposure\n---\nerDiagram\n    drug_exposure {\n        drug_exposure_id integer \"[PK not null] autogenerated identifier\"\n        person_id integer \"[FK not null]\"\n        drug_concept_id integer \"[not null] standard OMOP concept id used for analyses, contains strength/dose info\"\n        drug_exposure_start_date date \"[not null]\"\n        drug_exposure_start_datetime datetime\n        drug_exposure_end_date date \"[not null]\"\n        drug_exposure_end_datetime datetime\n        verbatim_end_date date\n        drug_type_concept_id integer \"[not null] e.g. prescriptions / dispensed / patient reported\"\n        stop_reason varchar20 \"reason for stopping as per source\"\n        refills integer\n        quantity float \"any numerical value for amount of drug\"\n        days_supply integer\n        sig varcharMAX \"verbatim instructions for drug\"\n        route_concept_id integer \"standard omop concept id in route domain\"\n        lot_number varchar50\n        provider_id integer \"[FK] clinician provider who recorded condition\"\n        visit_occurrence_id integer \"[FK]\"\n        visit_detail_id integer \"[FK]\"\n        drug_source_value varchar50 \"drug code as represented in source\"\n        drug_source_concept_id integer \"source mapped to omop but often left empty\"\n        route_source_value varchar50 \"verbatim route given in source\"\n        dose_unit_source_value varchar50 \"verbatim units given in source\"\n    }\n\n\n\n\n\n\n\n\n\nNone for now!\n\n\n\n\nConsider splitting out new table silver.ext_drug_exposure_ingredient as normalised lookup for multi-ingredient drugs that don’t have easy dm+d equivalent.",
    "crumbs": [
      "COMMON DATA MODEL",
      "Table/DRUG_EXPOSURE"
    ]
  },
  {
    "objectID": "pages/data_model/cdm_drug_exposure.html#drug_exposure",
    "href": "pages/data_model/cdm_drug_exposure.html#drug_exposure",
    "title": "London SDE/AIC Technical Documentation",
    "section": "",
    "text": "Structured data sources for medications prescribing and dispensing will generally always include:\n\n\n\n\n\n\n\nTable\nType\n\n\n\n\nElectronic prescribing and administration\nLegacy + Live\n\n\nPharmacy dispensing\nLegacy + Live\n\n\n\nTables are loaded to the database in batches, or through incremental ingestion via connection to a source database.\n\n\n\nData sources are staged as stg_{source}__{entity} (if necessary, with an initial step of base_{source}__{entity} prior to unioning). This may include column renaming and edge case handling.\n\n\n\nDifferent data sources are UNIONED into a common dataset for representing medications that are dispensed from pharmacy to inpatient, outpatient, and to-take-away. This table does not contain data from specialty specific systems such as chemotherapy.\nPatients must first be assigned a person_uuid. Where dispensing is attached to a particular hospital admission or attendance, these spells or attendances must first be assigned a visit_occurrence_id.\nThe column drug_type helps interpretation, and will indirectly map to OMOP drug_type_concept_id: - dispensing_unknown indicates a drug that was ordered for dispensing from pharmacy, but the data source does not provide information to indicate whether this dispensing was carried out; - dispensing_dispensed indicates a drug that was ordered and dispensed to patient from pharmacy; - dispensing_notdispensed indicates a drug that was ordered for dispensing, but ultimately not dispensed.\nThis table gives flexibility for highly detailed source systems, including possiblities for recording formulations and prescribed doses and instructions for each drug.\n\n\n\n\n\n---\ntitle: Drug Exposure (Dispensing) Intermediate Table\n---\nerDiagram\n    int_drug_exposure_dispensing {\n        drug_exposure_id integer \"[PK] autogenerated identifier\"\n        person_uuid uuid \"[FK ext_person] standardised unique person id\"\n        drug_exposure_start_date date\n        drug_exposure_start_datetime datetime\n        drug_exposure_end_date date\n        drug_exposure_end_datetime datetime        \n        drug_source_value varchar \"drug code as represented in source\"\n        drug_source_value_name varchar \"drug name as represented in source - may include formulation\"\n        domain_id varchar \"most relevant omop domain\"\n        source_vocabulary_id varchar \"id of source vocab\"\n        drug_type varchar \"status of drug, dispensing_unknown, dispensing_dispensed, dispensing_notdispensed\"\n        drug_location varchar \"free text for location context - e.g. ward name, or inpatient, outpatient, TTA\"\n        drug_desc varchar \"additional free text for further qualification, e.g. resupply, new supply\"\n        route_source_value varchar \"route as represented in the source\"\n        item_formulation_source_value varchar \"if available, best string that fully describes item formulation, e.g. 500mg tablet\"\n        item_strength_quantity_source_value float \"strength of one item of drug e.g. 500\"\n        item_strength_units_source_value varchar \"units given to one item e.g. mg\"        \n        item_type_source_value varchar \"type of item, e.g. tablet\"\n        dose_instruct_source_value varchar \"if available, best string that captures dosing instructions, e.g. 1g four times a day\"\n        dose_quantity_source_value float \"dose prescribed e.g. 1\"\n        dose_unit_source_value varchar \"units given to the prescribed dose e.g. g\"\n        dose_frequency_source_value varchar \"dosing instructions e.g. four times a day\"\n        days_supply integer \"how many days given\"\n        stop_reason varchar \"stop reason where given in source\"\n        sig varchar \"additional verbatim instructions for drug\"\n        visit_occurrence_id integer \"[FK ext_visit_occurrence] standardised unique visit id\"\n        source_table_provenance varchar \"source table name\"\n        source_row_id uuid \"unique row id for the single concept that is generated at ingestion\"\n    }\n\n\n\n\n\n\n\n\n\nDifferent data sources are UNIONED into a common dataset for representing medications that are prescribed +/- administered while attending a hospital location. This table does not contain data from specialty specific systems such as chemotherapy.\nPatients must first be assigned a person_uuid. Where dispensing is attached to a particular hospital admission or attendance, these spells or attendances must first be assigned a visit_occurrence_id.\nThe column drug_type helps interpretation, and will indirectly map to OMOP drug_type_concept_id: - prescribing_unknown indicates a drug that was prescribed, but the data source does not provide information to indicate whether the drug was administered or not - prescribing_administered indicates that a drug was prescribed and administered to the patient - presribing_notadministered indicates that a drug was prescribed but was explicitly cancelled or otherwise not given\nThis table also gives flexiblity for inputting special prescription/administration types, such as infusions.\n\n\n\n\n\n---\ntitle: Drug Exposure (Prescribing) Intermediate Table\n---\nerDiagram\n    int_drug_exposure_prescribing {\n        drug_exposure_id integer \"[PK] autogenerated identifier\"\n        person_uuid uuid \"[FK ext_person] standardised unique person id\"\n        drug_exposure_start_date date\n        drug_exposure_start_datetime datetime\n        drug_exposure_end_date date\n        drug_exposure_end_datetime datetime        \n        drug_source_value varchar \"drug code as represented in source\"\n        drug_source_value_name varchar \"drug name as represented in source - may include formulation\"\n        domain_id varchar \"most relevant omop domain\"\n        source_vocabulary_id varchar \"id of source vocab\"\n        drug_type varchar \"status of drug, prescribing_unknown, prescribing_administered, prescribing_notadministered\"\n        drug_location varchar \"free text for location context - e.g. ward name or clinic name\"\n        drug_desc varchar \"additional free text for further qualification, e.g. patient refused\"\n        route_source_value varchar \"route as represented in the source\"\n        item_formulation_source_value varchar \"best string that fully describes item formulation, particularly infusions: e.g. 10mg/ml propofol emulsion\"       \n        item_type_source_value varchar \"type of item, e.g. emulsion\"        \n        dose_instruct_source_value varchar \"best string that captures dosing, e.g. 100mg\"\n        dose_quantity_source_value float \"dose prescribed e.g. 100\"\n        dose_unit_source_value varchar \"units given to the prescribed dose e.g. mg\"\n        dose_frequency_source_value varchar \"dosing instructions e.g. once stat\"\n        infusion_rate_source_value varchar \"rate of infusion between start_datetime and end_datetime\"\n        infusion_rate_quantity_source_value float \"rate of infusion as number\"\n        infusion_rate_unit_source_value varchar \"rate of infusion units\"\n        stop_reason varchar \"stop reason where given in source\"\n        sig varchar \"additional verbatim instructions for drug\"\n        visit_occurrence_id integer \"[FK ext_visit_occurrence] standardised unique visit id\"\n        source_table_provenance varchar \"source table name\"\n        source_row_id uuid \"unique row id for the single concept that is generated at ingestion\"\n    }\n\n\n\n\n\n\n\n\n\nThis is the transformed version of ingested drug_exposure tables. It includes dispensing and administration (specified through drug_type). Concepts in this table are mapped to OMOP standards, and column naming is compatible, but it contains the following differences:\n\nMappings are made to OMOP at same granularity as original source value, as well as to the drug ingredient(s);\nMapping is made by default to dm+d due to NHS/UK origin, with further mapping to RxNorm when transforming to vanilla OMOP;\nStandardised concept codes/names are surfaced, and indexed, to enable user-friendly exploration and visualisation without the need for large joins;\nOMOP CDM 5.4 columns that are not relevant to the NHS, or to intended purposes, are excluded. When converting to vanilla OMOP, these columns remain empty;\nSource, table, and systems provenance are maintained, and closest provenance type is mapped to drug_type_concept_id per OMOP;\nGreater granularity in strength, dose, and infusion characteristics are allowed.\n\n\n\n\n\n\n---\ntitle: OMOP_EXT Drug Exposure\n---\nerDiagram\n    ext_drug_exposure {\n        drug_exposure_id integer \"[PK] autogenerated identifier\"\n        person_uuid uuid \"[FK ext_person] standardised unique person id\"\n        drug_exposure_start_date date\n        drug_exposure_start_datetime datetime\n        drug_exposure_end_date date\n        drug_exposure_end_datetime datetime  \n        drug_concept_id integer \"OMOP standard concept id\"\n        drug_concept_code varchar \"OMOP standard concept code\"\n        drug_concept_name varchar \"OMOP standard concept name\"\n        drug_vocabulary_id varchar \"OMOP standard vocabulary\" \n        drug_ingredient_concept_id integer \"OMOP standard concept id for ingredient(s)\"\n        drug_ingredient_concept_code varchar \"OMOP standard concept code for ingredient(s)\"\n        drug_ingredient_concept_name varchar \"OMOP standard concept name for ingredient(s)\"            \n        drug_ingredient_vocabulary_id varchar \"OMOP standard vocabulary for ingredient(s)\"\n        drug_type_concept_id integer \"OMOP classification for type of drug record\"                   \n        drug_type varchar \"status of drug - see previous notes\"\n        drug_location varchar \"free text for location context\"\n        drug_desc varchar \"additional free text for further qualification\"\n        route_concept_id integer \"OMOP standard concept id for route\"\n        route_concept_name varchar \"OMOP standard concept name for route\"\n        item_formulation_source_value varchar \"if available, best string that fully describes strength/formulation/concentration\"\n        item_strength_quantity_source_value float \"strength of one item of drug e.g. 500\"\n        item_strength_units_source_value varchar \"units given to one item e.g. mg\"        \n        item_type_source_value varchar \"type of item, e.g. tablet\"\n        dose_instruct_source_value varchar \"if available, best string that captures dosing instructions, e.g. 1g four times a day\"\n        dose_quantity_source_value float \"dose prescribed e.g. 1\"\n        dose_unit_source_value varchar \"units given to the prescribed dose e.g. g\"\n        dose_frequency_source_value varchar \"dosing instructions e.g. four times a day\"\n        infusion_rate_source_value varchar \"if available, best string that captures rate of infusion between start_datetime and end_datetime\"\n        infusion_rate_quantity_source_value float \"rate of infusion as number\"\n        infusion_rate_unit_source_value varchar \"rate of infusion units\"\n        days_supply integer \"how many days supply dispensed\"\n        stop_reason varchar \"stop reason where given in source\"\n        sig varchar \"additional verbatim instructions for drug\"\n        visit_occurrence_id integer \"[FK ext_visit_occurrence] standardised unique visit id\"\n        drug_source_value varchar \"drug code as represented in source\"\n        drug_source_value_name varchar \"drug name as represented in source - may include formulation\"     \n        route_source_value varchar \"route as represented in the source\"           \n        source_table_provenance varchar \"source table name\"\n        source_row_id uuid \"unique row id for the single concept that is generated at ingestion\"\n    }\n\n\n\n\n\n\n\n\n\nThis table captures records about the exposure to a Drug ingested or otherwise introduced into the body. A Drug is a biochemical substance formulated in such a way that when administered to a Person it will exert a certain biochemical effect on the metabolism. Drugs include prescription and over-the-counter medicines, vaccines, and large-molecule biologic therapies. Radiological devices ingested or applied locally do not count as Drugs.\n\n\n\n\n\n---\ntitle: OMOP Drug Exposure\n---\nerDiagram\n    drug_exposure {\n        drug_exposure_id integer \"[PK not null] autogenerated identifier\"\n        person_id integer \"[FK not null]\"\n        drug_concept_id integer \"[not null] standard OMOP concept id used for analyses, contains strength/dose info\"\n        drug_exposure_start_date date \"[not null]\"\n        drug_exposure_start_datetime datetime\n        drug_exposure_end_date date \"[not null]\"\n        drug_exposure_end_datetime datetime\n        verbatim_end_date date\n        drug_type_concept_id integer \"[not null] e.g. prescriptions / dispensed / patient reported\"\n        stop_reason varchar20 \"reason for stopping as per source\"\n        refills integer\n        quantity float \"any numerical value for amount of drug\"\n        days_supply integer\n        sig varcharMAX \"verbatim instructions for drug\"\n        route_concept_id integer \"standard omop concept id in route domain\"\n        lot_number varchar50\n        provider_id integer \"[FK] clinician provider who recorded condition\"\n        visit_occurrence_id integer \"[FK]\"\n        visit_detail_id integer \"[FK]\"\n        drug_source_value varchar50 \"drug code as represented in source\"\n        drug_source_concept_id integer \"source mapped to omop but often left empty\"\n        route_source_value varchar50 \"verbatim route given in source\"\n        dose_unit_source_value varchar50 \"verbatim units given in source\"\n    }\n\n\n\n\n\n\n\n\n\nNone for now!\n\n\n\n\nConsider splitting out new table silver.ext_drug_exposure_ingredient as normalised lookup for multi-ingredient drugs that don’t have easy dm+d equivalent.",
    "crumbs": [
      "COMMON DATA MODEL",
      "Table/DRUG_EXPOSURE"
    ]
  }
]